% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/or_rr.R
\name{estimate_rr}
\alias{estimate_rr}
\title{Estimate relative risks from distribution parameters via integration}
\usage{
estimate_rr(
  distdf,
  colnms = c(outcome = "outcome", dist = "dist", par1 = "par1", par2 = "par2", n = "n",
    mean = "mean", sd = "sd"),
  stvs = NULL,
  ll_fun = rr_log_likelihood
)
}
\arguments{
\item{distdf}{A data frame with one row per outcome group, containing:
\itemize{
\item \code{outcome}: Binary outcome indicator (0 or 1).
\item \code{dist}: Distribution name (e.g., \code{"normal"}, \code{"lognormal"}).
\item \code{par1}: First distribution parameter (e.g., mean or shape).
\item \code{par2}: Second distribution parameter (e.g., SD or scale).
\item \code{n}: Sample size for each group.
\item \code{mean}, \code{sd}: Optional; if not provided, computed from \code{par1}/\code{par2}.
}}

\item{colnms}{Named character vector mapping standard column names to
actual column names in \code{distdf}. Default assumes standard names.}

\item{stvs}{Optional starting values for optimization: \code{c(intercept, slope)}.}

\item{ll_fun}{Log-likelihood function (default: \code{\link{rr_log_likelihood}}).}
}
\value{
A named numeric vector with components:
\item{RR}{Relative risk (exponentiated slope coefficient).}
\item{log(RR)}{Log relative risk (slope coefficient).}
\item{SE(log(RR))}{Sandwich-adjusted standard error of log(RR).}
\item{p}{Two-sided p-value testing log(RR) = 0.}
\item{LB2.5, UB97.5}{95\\% confidence interval for RR.}

The vector has an attribute \code{"complete"} containing the full
\code{ucminf} output, including \code{vcov} (robust sandwich variance),
\code{vcov_naive} (model-based variance), and \code{SE_naive}.
}
\description{
Computes relative risks (RR) relating a continuous predictor to a binary
outcome using the robust Poisson method (log-link GLM with sandwich-corrected
standard errors). Unlike simulation-based approaches, this function integrates
the log-likelihood directly over the predictor distributions, providing
more precise and faster estimates.
}
\details{
This function uses the robust Poisson regression approach, which models
\code{P(Y=1|X) = exp(alpha + beta*X)} using a Poisson quasi-likelihood.
The sandwich variance estimator corrects for variance misspecification.

The method integrates the log-likelihood over the quantile functions of X
in each outcome group, avoiding Monte Carlo error from simulation-based methods.

Supported distributions: normal, lognormal, exponential, beta, gamma, weibull.
}
\examples{
\dontrun{
# Example: RR for normal distributions
df <- data.frame(
  outcome = c(0, 1, 0, 1),
  dist = "normal",
  par1 = c(9.3, 8.7, 8.4, 7.7),  # means
  par2 = c(1.6, 1.9, 1.3, 1.3),  # SDs
  n = c(188, 38, 188, 38)
)
result <- estimate_rr(df)
print(result)

# Access robust vs naive SEs
attr(result, "complete")$SE         # sandwich-adjusted
attr(result, "complete")$SE_naive   # model-based
}

}
\seealso{
\code{\link{estimate_or}} for odds ratios
}
